# 1 Care and feeding of iptables

This chapter covering essential aspects of properly installing, maintaining, and interacting with the iptables firewall on Linux systems. Also , aspects such as iptables administration from the perspectives of both kernel and userland, as well as how to build and maintain an iptables firewall policy. 

## 1.1 iptables

The iptables firewall is developed by Netfilter Project and has been available to the masses as part of Linux since the release of the Linux 2.4 kernel in January 2001.

The differences between the terms *iptables* and *Netfilter* have been a source of some confusion in the Linux community. To reduce the complexity, think them as follow:

 - Netfilter: providing the framework on which *iptables* builds firewall functionality.
 - iptables: refers to the userland tool that parses the command line and communicates a firewall policy to the kernel.

Terms such as *tables* , *chains* , *matches* , and *targets* make sense in the context of iptables.

Netfilter does not filter traffic itself--it just allows functions that *can* filter traffic to be hooked into the right spot within the kernel. The Netfilter Project also provides serveral pieces of infrastructure in the kernel, such as connection tracking and logging; any iptables policy can use these facilities to perform specialized packet processing.

## 1.2 Packet Filtering with iptables

An iptables policy is built from an ordered set of *rules* , which describe to the kernel the actions that should be taken against certain classes of packets. Each iptables rule is applied to a chain within a table.  **An iptables *chain* is a collection of rules that are compared , in order , against packets that share a common characteristic (such as being routed to the Linux system, as opposed to away from it.)**

### 1.2.1 Tables

A *table* is an iptables construct that delineates broad categories of functionality, such as packet filtering or Network Address Translation(NAT). There are four tables: **filter** , **nat** , **mangle** , and **raw** .

Filtering rules are applied to the filter table.

NAT rules are applied to the nat table.

Specialized rules that alter packet data are applied to the mangle table.

Rules that should function independently of the Netfilter connection-tracking subsystem are applied to the raw table.

### 1.2.2 Chains

Each table has its own set of built-in chains, but user-defined chains can also be created so that the user can build a set of rules that is related by a common tag such as **INPUT_ESTABLISHED** or **DMZ_NETWORK** . The most important built-in chains for our purposes are the **INPUT** , **OUTPUT** , and **FORWARD** chains in the filter table:

- The **INPUT** chain is traversed by packets that are **destined for the local Linux system after a routing calculation is made within the kernel(i.e., packets destined for a local socket).
- The **OUTPUT** chain is reserved for packets that are generated by the Linux system itself.
- The **FORWARD** chain governs packets that are **



